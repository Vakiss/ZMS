{% extends 'main/base.html' %}
{% block content %}
<h2>Naujas įvykis gyvuliui {{ animal.number }}</h2>
<form method="post">
  {% csrf_token %}
  {% if form.non_field_errors %}
    <div class="error">
      {{ form.non_field_errors }}
    </div>
  {% endif %}

  <div>
    <label for="id_event_type">Event type:</label>
    {{ form.event_type }}
    {% if form.event_type.errors %}
      <div class="error">{{ form.event_type.errors }}</div>
    {% endif %}
  </div>
  <div>
    <label for="id_date">Event date:</label>
    {{ form.date }}
  </div>
  <div>
    <label for="id_notes">Notes:</label>
    {{ form.notes }}
  </div>

  <!-- Čia prasideda palikuonio laukai -->
  <div id="child_fields" style="display: none;">
    <h3>Prieauglio duomenys</h3>
    <div>
      <label for="id_child_name">Child name:</label>
      {{ form.child_name }}
    </div>
    <div>
      <label for="id_child_number">Child number:</label>
      {{ form.child_number }}
    </div>
    <div>
      <label for="id_child_gender">Child gender:</label>
      {{ form.child_gender }}
    </div>
    <div>
      <label for="id_child_color">Child color:</label>
      {{ form.child_color }}
    </div>
  </div>

  <button type="submit">Patvirtinti</button>
</form>

<script>
  const eventTypeSelect = document.getElementById("id_event_type");
  const childFieldsDiv = document.getElementById("child_fields");

  function toggleChildFields() {
    console.log("Selected event type:", eventTypeSelect.value);
    if (eventTypeSelect.value.trim().toLowerCase() === "prieauglio atsivedimas") {
      childFieldsDiv.style.display = "block";
    } else {
      childFieldsDiv.style.display = "none";
    }
  }

  toggleChildFields();
  eventTypeSelect.addEventListener("change", toggleChildFields);
</script>
{% endblock %}